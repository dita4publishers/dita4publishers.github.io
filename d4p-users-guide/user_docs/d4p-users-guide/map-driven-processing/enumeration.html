<?xml version="1.0" encoding="UTF-8"?><html xml:lang="en-us" lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
<meta name="copyright" content="(C) Copyright 2005"></meta>
<meta name="DC.rights.owner" content="(C) Copyright 2005"></meta>
<meta name="DC.Type" content="concept"></meta>
<meta name="DC.Title" content="Numbering Things: Collected Data and Enumeration"></meta>
<meta name="abstract" content="How to use the collected enumeration data to number things in output."></meta>
<meta name="description" content="How to use the collected enumeration data to number things in output."></meta>
<meta name="DC.subject" content="enumeration, numbering, collected data"></meta>
<meta name="keywords" content="enumeration, numbering, collected data"></meta>
<meta name="DC.Relation" scheme="URI" content="map-driven-processing.html"></meta>
<meta name="DC.Relation" scheme="URI" content="data-collection.html"></meta>
<meta name="DC.Relation" scheme="URI" content="index-generation.html"></meta>
<meta name="prodname" content="DITA For Publishers"></meta>
<meta name="prodname" content="DITA For Publishers"></meta>
<meta name="prodname" content="DITA For Publishers"></meta>
<meta name="prodname" content="DITA For Publishers"></meta>
<meta name="prodname" content="DITA For Publishers"></meta>
<meta name="version" content="1"></meta>
<meta name="version" content="1"></meta>
<meta name="version" content="1"></meta>
<meta name="version" content="1"></meta>
<meta name="version" content="1"></meta>
<meta name="release" content="0"></meta>
<meta name="release" content="0"></meta>
<meta name="release" content="0"></meta>
<meta name="release" content="0"></meta>
<meta name="release" content="0"></meta>
<meta name="modification" content="0RC17"></meta>
<meta name="modification" content="0RC17"></meta>
<meta name="modification" content="0RC17"></meta>
<meta name="modification" content="0RC17"></meta>
<meta name="modification" content="0RC17"></meta>
<meta name="DC.Creator" content="W. Eliot Kimber"></meta>
<meta name="DC.Creator" content="W. Eliot Kimber"></meta>
<meta name="DC.Creator" content="W. Eliot Kimber"></meta>
<meta name="DC.Creator" content="W. Eliot Kimber"></meta>
<meta name="DC.Creator" content="W. Eliot Kimber"></meta>
<meta name="DC.Format" content="XHTML"></meta>
<meta name="DC.Identifier" content="conceptId"></meta>
<link rel="stylesheet" type="text/css" href="../../../commonltr.css"></link>
<title>Numbering Things: Collected Data and Enumeration</title>
</head>
<body id="conceptId">


 <h1 class="title topictitle1">Numbering Things: Collected Data and Enumeration</h1>
 
  
 <div class="body conbody"><p class="shortdesc">How to use the collected enumeration data to number things in
    output.</p>

   <p class="p">The collected data includes data specifically designed to make numbering
      (enumeration) easy. The enumeration structure reflects the entire
      publication (root map) and contains the minimum amount of structure and
      data needed to number things, generate navigation lists, resolved cross
      references, and so on. This includes all topics, figures and tables with
      titles, sections, examples, and all div-type elements
      (<code>&lt;bodydiv&gt;</code>, <code>&lt;sectiondiv&gt;</code>,
      <code>&lt;div&gt;</code>).</p>

    <div class="p">The XML structure of the enumeration data looks like
      this:<pre class="pre codeblock">&lt;mapdriven:collected-data xmlns:mapdriven="http://dita4publishers.org/mapdriven"
                          xmlns:index-terms="http://dita4publishers.org/index-terms"
                          xmlns:enum="http://dita4publishers.org/enumerables"&gt;
   <strong class="ph b">&lt;enum:enumerables&gt;</strong>
      &lt;frontmatter xmlns="http://dita4publishers.org/enumerables"
                   class="+ map/topicref pubmap-d/frontmatter "
                   sourceId="-frontmatter-22-110-121"
                   xtrc="frontmatter:1"
                   docUri="file:/Users/ekimber/workspace/ebook-conversion/dita/temp/epub/Tax-Preparation.ditamap"&gt;
         &lt;inside-front-cover class="+ map/topicref pubmap-d/inside-front-cover "
                             sourceId="-inside-front-cover-23-118-52"
                             xtrc="inside-front-cover:1"
                             docUri="file:/Users/ekimber/workspace/ebook-conversion/dita/temp/epub/Tax-Preparation.ditamap"&gt;
            &lt;title&gt;Front Cover&lt;/title&gt;
         &lt;/inside-front-cover&gt;
         &lt;preface class="+ map/topicref pubmap-d/preface "
                  sourceId="-preface-30-112-69"
                  xtrc="preface:1"
                  docUri="file:/Users/ekimber/workspace/ebook-conversion/dita/temp/epub/Tax-Preparation.ditamap"&gt;
            &lt;title&gt;Copyright Page&lt;/title&gt;
         &lt;/preface&gt;
      &lt;/frontmatter&gt;
      ...
    <strong class="ph b">&lt;/enum:enumerables&gt;</strong>
    ...
&lt;/mapdriven:collected-data&gt;</pre>
</div>

    <p class="p">The <code>&lt;enum:enumerables&gt;</code> reflects the hierarchical
      structure of the publication. Each element reflects its DITA
      <code>@class</code> value, the URI of the source document it came from,
      and its "source ID", which is a unique identifier for the element
      constructed from its original context. The source ID is generated by the
      DITA utilities function <span class="keyword">df:generate-dita-id()</span>.</p>

    <div class="p">To number an element in output processing, you generate the source ID for
      the element you want to number, then apply templates to the element that
      has that ID within the enumerables data in the mode
      <span class="keyword">enumeration</span>, as in this fragment for numbering
      figures:<pre class="pre codeblock">  ...
  <strong class="ph b">&lt;xsl:variable name="sourceId" select="df:generate-dita-id(.)" as="xs:string"/&gt;</strong>
  &lt;span class="figcap"&gt;
    <strong class="ph b">&lt;xsl:apply-templates select="$collected-data/enum:enumerables//*[@sourceId = $sourceId]"</strong>
      <strong class="ph b">mode="enumeration"/&gt;</strong>
      &lt;xsl:apply-templates select="*[contains(@class,' topic/title ')]" mode="figtitle"/&gt;
  &lt;/span&gt;
  ...</pre>
</div>

    <div class="p">In the mode enumeration you provide templates that implement your
      numbering rules,
      e.g.:<pre class="pre codeblock">  &lt;xsl:template mode="enumeration"  match="*[df:class(., 'topic/fig')][enum:title]"&gt;
    &lt;!-- Context item should be enum:* from the collected-data 
        
         NOTE: Within the collected data, all titles are normalized
         to enum:title with no @class attribute.
    --&gt;
    &lt;span class="enumeration fig-enumeration"&gt;
      &lt;xsl:text&gt;Figure &lt;/xsl:text&gt;      
      &lt;xsl:number count="*[df:class(., 'topic/fig')][enum:title]"
        level="any"
        format="1."
      /&gt;
      &lt;xsl:text&gt;Â &lt;/xsl:text&gt;
    &lt;/span&gt;
  &lt;/xsl:template&gt;</pre>
</div>

    <p class="p">Note that in this template, the usual <code>&lt;xsl:number&gt;</code>
      facility is used to number the figure. Because the enumeration data
      reflects the entire publication you can number figures across the entire
      publication, as in this example. Because the enumeration data also
      includes all the topic and topicheads in their map-defined hierarchy, you
      could also number things at a part, chapter, or other level, as long as
      it's provided for in the enumeration structure.</p>

 </div>

<div class="related-links">
<div class="familylinks">
<div class="parentlink"><strong>Parent topic:</strong> <a class="link" href="map-driven-processing.html">map-driven-processing.html</a></div>
<div class="previouslink"><strong>Previous topic:</strong> <a class="link" href="data-collection.html">data-collection.html</a></div>
<div class="nextlink"><strong>Next topic:</strong> <a class="link" href="index-generation.html">index-generation.html</a></div>
</div>
</div>

</body>
</html>